
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://jouvetg.github.io/igm-doc.github.io/modules/enthalpy/">
      
      
        <link rel="prev" href="../vert_flow/">
      
      
        <link rel="next" href="../particles/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.29">
    
    
      
        <title>enthalpy - IGM documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.76a95c52.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#igm-enthalpy-module" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="IGM documentation" class="md-header__button md-logo" aria-label="IGM documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            IGM documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              enthalpy
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="IGM documentation" class="md-nav__button md-logo" aria-label="IGM documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    IGM documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Installation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installation
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Examples/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Examples
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Running/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Running IGM
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Modules
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Modules
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1" >
        
          
          <label class="md-nav__link" for="__nav_4_1" id="__nav_4_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Pre-processing
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1">
            <span class="md-nav__icon md-icon"></span>
            Pre-processing
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../oggm_shop/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    oggm_shop
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../load_ncdf/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    load_ncdf
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../load_tif/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    load_tif
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../include_icemask/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    include_icemask
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pretraining/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pretraining
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../optimize/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    optimize
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" checked>
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Processing
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            Processing
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../clim_oggm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    clim_oggm
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../smb_oggm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    smb_oggm
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../iceflow/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    iceflow
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../time/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    time
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../thk/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    thk
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../vert_flow/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    vert_flow
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    enthalpy
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    enthalpy
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#igm-enthalpy-module" class="md-nav__link">
    <span class="md-ellipsis">
      IGM enthalpy module
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#description" class="md-nav__link">
    <span class="md-ellipsis">
      Description:
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#model" class="md-nav__link">
    <span class="md-ellipsis">
      Model:
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Model:">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ice-flow" class="md-nav__link">
    <span class="md-ellipsis">
      Ice flow
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#enthalpy" class="md-nav__link">
    <span class="md-ellipsis">
      Enthalpy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#basal-melt" class="md-nav__link">
    <span class="md-ellipsis">
      Basal melt
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#water-thickness" class="md-nav__link">
    <span class="md-ellipsis">
      Water thickness
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sliding-parametrization" class="md-nav__link">
    <span class="md-ellipsis">
      Sliding parametrization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ahrrenius-factor" class="md-nav__link">
    <span class="md-ellipsis">
      Ahrrenius factor
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pressure-adujsuted-temperature" class="md-nav__link">
    <span class="md-ellipsis">
      Pressure-adujsuted temperature
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#numerical-scheme" class="md-nav__link">
    <span class="md-ellipsis">
      Numerical scheme
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#numerical-stability-time-stepping" class="md-nav__link">
    <span class="md-ellipsis">
      Numerical stability -- time stepping
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dependencies" class="md-nav__link">
    <span class="md-ellipsis">
      Dependencies
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../particles/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    particles
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../rockflow/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    rockflow
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../glerosion/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    glerosion
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../avalanche/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    avalanche
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../gflex/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    gflex
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3" >
        
          
          <label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Post-processing
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3">
            <span class="md-nav__icon md-icon"></span>
            Post-processing
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../write_ncdf/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    write_ncdf
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../write_tif/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    write_tif
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../write_ts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    write_ts
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../plot2d/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    plot2d
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../write_particles/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    write_particles
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../print_info/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    print_info
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../print_comp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    print_comp
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../anim_plotly/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    anim_plotly
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../anim_mayavi/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    anim_mayavi
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../anim_video/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    anim_video
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Custom_Modules/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Custom Modules
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../About_GPUs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    About GPUs
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Credits_and_references/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Credits and references
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Variables/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Variables
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../FAQ/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FAQ
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#igm-enthalpy-module" class="md-nav__link">
    <span class="md-ellipsis">
      IGM enthalpy module
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#description" class="md-nav__link">
    <span class="md-ellipsis">
      Description:
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#model" class="md-nav__link">
    <span class="md-ellipsis">
      Model:
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Model:">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ice-flow" class="md-nav__link">
    <span class="md-ellipsis">
      Ice flow
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#enthalpy" class="md-nav__link">
    <span class="md-ellipsis">
      Enthalpy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#basal-melt" class="md-nav__link">
    <span class="md-ellipsis">
      Basal melt
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#water-thickness" class="md-nav__link">
    <span class="md-ellipsis">
      Water thickness
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sliding-parametrization" class="md-nav__link">
    <span class="md-ellipsis">
      Sliding parametrization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ahrrenius-factor" class="md-nav__link">
    <span class="md-ellipsis">
      Ahrrenius factor
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pressure-adujsuted-temperature" class="md-nav__link">
    <span class="md-ellipsis">
      Pressure-adujsuted temperature
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#numerical-scheme" class="md-nav__link">
    <span class="md-ellipsis">
      Numerical scheme
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#numerical-stability-time-stepping" class="md-nav__link">
    <span class="md-ellipsis">
      Numerical stability -- time stepping
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dependencies" class="md-nav__link">
    <span class="md-ellipsis">
      Dependencies
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<script> window.MathJax = { tex: { inlineMath: [['$', '$'], ['\\(', '\\)']], displayMath: [['$$', '$$'], ['\\[', '\\]']] }, svg: { fontCache: 'global' } }; </script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

<h3 id="igm-enthalpy-module"><h1 align="center" id="title">IGM enthalpy module  </h1></h3>
<p><strong>Warning: this rather complex module was not much tested so far, use it with care!</strong></p>
<h1 id="description">Description:</h1>
<p>This IGM module models the ice enthalpy, which permits to jointly model the ice temperature, as well as the water content created when the temperature hits the pressure melting points, and therefore energy conservation, which is not the case when modelling the sole temperature variable. The model is described in <a href="https://www.cambridge.org/core/journals/journal-of-glaciology/article/an-enthalpy-formulation-for-glaciers-and-ice-sheets/605D2EC3DE03B82F2A8289220E76EB27">(Aschwanden and al, JOG, 2012)</a>. Here, we used a simplified version largely inspired from the one implemented in <a href="https://www.pism.io/">PISM</a>. Other references that have helped are <a href="https://tc.copernicus.org/articles/9/217/2015/">(Kleiner and al, TC, 2015)</a> and <a href="https://www.sciencedirect.com/science/article/abs/pii/S0098300419311458">(Wang and al, 2020)</a>.</p>
<h1 id="model">Model:</h1>
<h2 id="ice-flow">Ice flow</h2>
<p>Here we only quickly sketch the components of the ice dynamical modelling necessary for modeling the Enthalpy.</p>
<p>Ice is assumed to be a Non Newtonian fluid, gouverned by Glen's flow law:
$$ \tau = A^{-1/n} | D({\bf u}) |^{1/n-1} D({\bf u}), $$</p>
<p>where $D({\bf U})$ and $\tau$ are the strain rate and deviatoric stress tensor, respectively. While a no-stress condition is applied on the top surface, we assume that
the basal shear stress  $\tau_b$ and the sliding velocity $u_b$ are linked by Weertmann power law at the glacier bed interface:
$$ 
 \tau_b = - c | u_b |^{m-1} u_b,
$$
where $c=\tau_c u_{th}^{-m}$ (unit: $Mpa \; m^{-m} \; y^m$), $\tau_c$ being the yield stress and $u_{th}$ being a parameter homegenous to ice velocity. This formalism is taken from PISM.</p>
<p>(Note that originally, IGM had $c^{-m}$ instead of $c$ above as "slidingco" with $u_{th}=1$. The newest runs under parameters "new_sliding_param", and $c$ has unit $MPa \; m^{-m} \; y^m$)</p>
<h2 id="enthalpy">Enthalpy</h2>
<p>The Enthalpy $E$ is a 3D variable defined everywhere in the ice as a function of the temperature $T$ and the water content $\omega$:</p>
<p>$$
\begin{align}
E(T, \omega,p) = 
\left{
\begin{array}{ll}
c_i (T- T_{\rm ref}), &amp; {\rm  if } \; T &lt; T_{\rm pmp} , \ 
E_{\rm pmp} + L \omega, &amp;<br />
{\rm if } \;  T = T_{\rm pmp} \; {\rm and } \; 0 \le \omega,
\end{array} 
\right.<br />
\end{align}
$$</p>
<p>where $c_i$ is the heat capacity, $T_{ref}$ is the reference temperature, $T_{\rm pmp} = T_{\rm pmp}(p) = T_0 - \beta p$ is the temperature pressure-melting point of ice, $E_{\rm pmp}(p)$  is the enthalpy pressure-melting point of ice defined as </p>
<p>$$ E_{\rm pmp}(p) = c_i (T_{\rm pmp}(p) - T_{\rm ref}), $$</p>
<p>where $L$ is the latent heat of fusion. According to the above defintion of enthalpy, we have two possible modes: i) the ice is cold, i.e. below the melting point, and the Enthalpy is simply proportional to the temperature minus a reference temperature ii) the ice is temperate and the Enthalpy continue to grow, the additional component $L \omega$ corresponding to the creation of water content by energy transfer. Therefore, it is straightforward to deduce $E$ from $T$ and $\omega$.</p>
<p>The enthalpy model consists of the following advection-diffusion equation (the horizontal diffusion being neglected):</p>
<p>$$ 
\begin{align}
&amp; \rho_i \left( \frac{\partial E}{ \partial t}
+ u_x \frac{\partial E}{ \partial x}
+ u_y \frac{\partial E}{ \partial y} 
+ u_z \frac{\partial E}{ \partial z} \right) 
 - \frac{\partial }{\partial z} \left(
K_{c,t} \frac{\partial E}{ \partial z} \right)
= \phi - \rho_w L D_w(\omega),
\end{align}
$$</p>
<p>where $\rho_i$ is the ice density, $K_{c,t}$ equals $K_c = k_i/c_i$ if the ice is cold ($E&lt;E_{pmp}$) or $K_t = \epsilon k_i/c_i$ otherwise, $\phi$ is the strain heating defined by (using Glen's flow law)</p>
<p>$$ \phi = D({\bf U}) \tau = A^{-1/n} | D({\bf u}) |^{1+1/n}, $$</p>
<p>where $D({\bf U})$ and $\tau$ are the strain rate and deviatoric stress tensor, respectively. The last source term $- \rho_w L D_w(\omega)$  permits to remove the water in temperate ice $D_w(\omega)$ being a drainage function ((Greve, 1997) and (Aschwanden et al., 2012)).</p>
<p>At the top ice surface, the enthalpy equation is constrained by the surface temperature (or equivalently the Enthalpy) provided by the climate forcing (Dirichlet condition). At the glacier bed, boundary conditions for the enthalpy equation are multiple (<a href="https://www.cambridge.org/core/journals/journal-of-glaciology/article/an-enthalpy-formulation-for-glaciers-and-ice-sheets/605D2EC3DE03B82F2A8289220E76EB27">(Aschwanden and al, JOG, 2012)</a>, <a href="https://tc.copernicus.org/articles/9/217/2015/">(Kleiner and al, TC, 2015)</a> and <a href="https://www.sciencedirect.com/science/article/abs/pii/S0098300419311458">(Wang and al, 2020)</a>.)</p>
<ul>
<li>$K_{c} \frac{\partial E}{ \partial z} = Q_{\rm geo} + Q_{\rm fh}$
if $E_b&lt;E_{\rm pmp}$ and $H_w = 0$, (cold base, dry) </li>
<li>$ E_b = E_{\rm pmp} $ if $E_b<E_{\rm pmp}$ and $H_w > 0$, (cold base, wet)</li>
<li>$ E_b = E_{\rm pmp} $ if $E_b \ge E_{\rm pmp}$ and $W_{till}&gt; 0$, zero temperate basal layer, (temperate base, cold ice)</li>
<li>$ K_{t} \frac{\partial E}{ \partial z} = 0$ if $E_b \ge E_{\rm pmp}$ and $W_{till} &gt; 0$, non-zero temperate basal layer, (temperate base, temp. ice)</li>
</ul>
<p>where $H_t$ is the height of the temperate basal layer, $Q_{\rm geo}$ and $Q_{\rm fh}$ are the geothermal heat flux, and the frictional heat flux, respectively. The latter is defined by 
$$ 
Q_{\rm fh} = \tau_b \cdot u_b = c | u_b |^{m+1}.
$$</p>
<p>As a matter of fact, the ice enthalpy (or equivalently temperature and water content) feedbacks the dynamical model in two ways. The Enthalpy directly impacts the sliding basal parametrization, while variations in temperature and water content cause ice softening or hardening. </p>
<h2 id="basal-melt">Basal melt</h2>
<p>When the temperature hits the pressure-melting point at the glacier bed (i.e. $E \ge E_{\rm pmp}$), the basal melt rate is calculated via the following equation:
$$
\begin{equation}
m_b = \frac{Q_{fr}+Q_{geo} - K_{t,c} \frac{\partial E}{ \partial z} }{\rho_i L}. 
\end{equation}
$$
The basal melt rate is further adjusted positively to account for the drainage of the water content generated along the entire column.</p>
<h2 id="water-thickness">Water thickness</h2>
<p>The basal water thickness in the till $W_{till}$ is computed directly from the basal melt rate as follows:
$$
\begin{equation}
\frac{\partial W_{till} }{ \partial z} = \frac{m_b}{\rho_w} - C,
\end{equation}
$$
where $C$ is a simple drainage parameter. The till is assumed to be saturated when it reaches the value $W_{till}^{max} = 2$ m, therefore, the till water thickness is bounded to this value. The effective thickness of water within the till $N_{till}$ is computed from the saturation ratio $s= W_{till} / W_{till}^{max}$ by the formula <a href="https://gmd.copernicus.org/articles/8/1613/2015/gmd-8-1613-2015.html">(Bueler and Pelt, GMD, 2015)</a>:
$$
\begin{equation}
N_{till} = \min \left{ P_0, N_0 \left( \frac{\delta P_0}{N_0} \right)^s 10^{(e_0/C_c)(1-s)} \right},
\end{equation}
$$
where $P_0$ is the ice overburden pressure and the remaining parameters are constant. </p>
<h2 id="sliding-parametrization">Sliding parametrization</h2>
<p>Last, the sliding coefficient $c$ is defined with the Mohr-Coulomb (Cuffey and Paterson, 2010) sliding law with the effective pressure in the till:
$$
\begin{align}
c  = \tau_c u_{th}^{-m} &amp; = N_{till} \tan(\phi) u_{th}^{-m}, \
\end{align}
$$
where $\phi$ is the till friction angle.</p>
<h2 id="ahrrenius-factor">Ahrrenius factor</h2>
<p>We use the Glen-Paterson-Budd-Lliboutry-Duval law, where</p>
<p>$$A(T,\omega)= A_c(T)(1+C \omega) $$</p>
<p>where $A_c(T)$ is given by the Paterson-Budd law:</p>
<p>$$  A_c(T)= A \exp{( −Q / (R \, T_{pa}) )} $$</p>
<p>where $A$ and $Q$ have different values below and above a threshold temperature. </p>
<p>$$ A = 3.985 \times 10^{-13} \, s^{-1} Pa^{-3}, \textrm{ if } T &lt;263.15 K$$
$$ A = 1.916 \times 10^3 \, s^{-1} Pa^{-3}, \textrm{else.}$$
and
$$ Q =  60 kJ mol^{-1},  \textrm{ if } T &lt;263.15 K$$
$$ Q = 139 kJ mol^{-1},  \textrm{else.}$$</p>
<p>These values are taken from (Paterson 1994).</p>
<h2 id="pressure-adujsuted-temperature">Pressure-adujsuted temperature</h2>
<p>Melting point temperature at pressure is adjusted for pressure as follows
$$ T_{pmp} = T_{0} - \beta \rho g d, $$
where $d$ is the depth, $T_{0}=273.15$ is the melting temperate at standart pressure (unit [$K$]),  $\beta = 7.9 \; 10^{-8}$ is Clausius-Clapeyron constant (unit [$K Pa^{-1}$]). Therefore, one define the "pressure-adjusted" temperaure $T_{pa}$ as being the temperature with a shift such that its metling point temperature reference is always zero:
$$ T_{pa} = T + \beta \rho g z. $$</p>
<h1 id="numerical-scheme">Numerical scheme</h1>
<p>To solve the Enthalpy equation numerically, one makes use of the same horizontal and vertical discretization as used for the ice flow.
Treating the horizontal advection term explicitly using an upwind scheme, the Enthalpy equation with its boundary conditions can be solved column-wise as a one-dimensional advection-diffusion equation. This is achieved implicitly for both the vertical advection and the diffusion term, which are approximated by finite differences. For each column, 
one solves a small tridiagonal using the Tridiagonal Matrix Algorithm (TDMA) aka Thomas Algorithm.</p>
<p>Updating the Enthalpy at time $t^{n+1}$ requires to perform several sub-steps (in function ''update_enthalpy(params,state)''):</p>
<ul>
<li>compute the mean surface temperature $T^n_s$ to enforce upper surface Dirichlet Boundary condition,</li>
<li>compute the vertical discretization with respect to the ice geometry $h^n$,</li>
<li>compute the temperature $T_{pmp}$ and enthalpy $E_{pmp}$ at pressure meltinf point,</li>
<li>compute the ice temperature field $T^n$ from the Enthalpy $E^n$,</li>
<li>compute the Arrhenius factor $A(T^n)$ from temperature $T^n$,</li>
<li>compute the 3D strain heat $\phi^n$ from ice flow field ${\bf u}^{n+1}$ and rrhenius factor $A(T^n)$,</li>
<li>compute the 2D basal frictional heat $Q_{\rm fh}^n$, from basal velocity field ${\bf u}$ and sliding coefficient $c^n$,</li>
<li>compute the $UPWIND^n$ term for the explicit treatement of the horizontal advection,</li>
<li>compute the surface Enthalpy $E^n_s$ from the surface temperature $T^n_s$,</li>
<li>compute the new enthalpy $E^{n+1}$ field solving one-dimension column-wise advection-diffusion equation, as well as the basal melt rate, <strong>this is the main updating step</strong>,</li>
<li>compute the water thickness in the till $W^{n+1}$,</li>
<li>compute the sliding parametrization $c^{n+1}$. </li>
</ul>
<h1 id="numerical-stability-time-stepping">Numerical stability -- time stepping</h1>
<p>Here one updates the enthalpy as many times as the ice flow, we assume that the time step for the explicit advection is more restrictive than the implicit diffusion-advection problem.</p>
<h1 id="dependencies">Dependencies</h1>
<ul>
<li>the enthalpy module builds upon the module iceflow</li>
<li>one needs to have the vertical_iceflow module activated to provide the vertical velocitiy</li>
<li>make sure to have params.dim_arrhenius = 3</li>
<li>make sure to have params.new_friction_param = true</li>
<li>make sure to ave enough retraining retrain_iceflow_emulator_freq: 1, possibly retrain_iceflow_emulator_nbit more than 1.</li>
</ul>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": 2.2}</script>
    
    
      <script src="../../assets/javascripts/bundle.fe8b6f2b.min.js"></script>
      
    
  </body>
</html>